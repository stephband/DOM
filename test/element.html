<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="author" content="stephband" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width" />

    <title>Test element()</title>

    <link rel="icon" type="image/png" href="./images/logo-32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="./images/logo-64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="./images/logo-128.png" sizes="128x128">

    <script title="load">
    document.documentElement.className += ' js content-loading loading';
    window.addEventListener('DOMContentLoaded', () => document.documentElement.classList.remove('content-loading'));
    // Wait for other load handlers to run first - Literal does a few things on
    // load (eg. data-targetable scrolls) and we want them to run before the loading
    // class is removed
    window.addEventListener('load', () => window.requestAnimationFrame(() => document.documentElement.classList.remove('loading')));
    window.DEBUG = true;
    </script>

    <style></style>
</head>

<body class="2x-grid grid">
    <header>
        <h1 class="doctext-01">Element</h1>
    </header>

    <section title="Test" id="test">
        <test-element attr="1">
            <p>Slotted content</p>
        </test-element>
    </section>

    <pre id="results"></pre>

    <script type="module">
        import element from "../modules/element.js";

        console.log('Test 1 -----');

        element('test-element', {
            construct: function(shadow) {
                console.log('element', 'construct');

                const slot = document.createElement('slot');
                shadow.append(slot);

                slot.addEventListener('slotchange', function(e) {
                    console.log('element', 'slotchange', e.target, slot.assignedElements());
                });
            },

            connect: function() {
                console.log('element', 'connect');
            },

            load: function() {
                console.log('element', 'load');
            }
        }, {
            attr: {
                attribute: function(value) {
                    console.log('element', 'setAttribute("attr", ' + value + ')');
                    this.attr = value;
                },

                set: function() {
                    console.log(this.children[0]);
                }
            }
        }, '../../bolt/elements/html.css');

        setTimeout(function() {
            console.log('Test 2 -----');

            const elem    = document.createElement('test-element');
            const slotted = document.createElement('p');
            slotted.innerHTML = 'Slotted content';
            elem.append(slotted);
            console.log('---');
            elem.setAttribute('attr', '2');
            console.log('----');
            document.getElementById('test').append(elem);
            console.log('-----');
        }, 1000);

    </script>
</body>
